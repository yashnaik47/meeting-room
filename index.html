<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meeting Room Booking — 30-min Slots</title>
  <style>
    :root{
      --bg:#f4f7fb;
      --card:#ffffff;
      --accent:#0b69ff;
      --ok:#16893a;
      --danger:#b42318;
      --muted:#6b7280;
      --radius:12px;
    }
    *{box-sizing:border-box}
    body{
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin:0;padding:28px;background:linear-gradient(180deg,var(--bg),#eef3fb); color:#0f1724;
      display:flex;flex-direction:column;align-items:center;gap:18px;
    }

    .top {
      width:100%;max-width:1100px;display:flex;gap:12px;align-items:center;justify-content:space-between;
    }
    h1{margin:0;font-size:20px}
    .user {
      display:flex;gap:8px;align-items:center;
    }
    .user input{
      padding:10px 12px;border-radius:10px;border:1px solid #d1d5db;width:220px;
      font-size:14px;
    }
    .btn-clear {
      padding:10px 14px;border:none;border-radius:8px;
      background:#e11d48;color:white;font-weight:600;cursor:pointer;
    }
    .btn-clear:hover{background:#b91c1c}

    .legend{font-size:13px;color:var(--muted)}

    .roomsWrap{
      width:100%;max-width:1100px;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
      gap:18px;
    }

    .roomCard{
      background:var(--card);border-radius:var(--radius);padding:16px;
      box-shadow:0 8px 20px rgba(15,23,42,0.06);display:flex;flex-direction:column;gap:10px;
    }
    .roomHeader{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .roomHeader h2{margin:0;font-size:16px}
    .slots{display:flex;flex-direction:column;gap:8px;max-height:520px;overflow:auto;padding-right:6px}
    .slotRow{
      display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-radius:10px;
      border:1px solid rgba(15,23,42,0.04);background:linear-gradient(180deg, #fff, #fbfdff);
    }
    .slotLabel{font-size:14px;color:#0f1724}
    .slotMeta{font-size:13px;color:var(--muted);margin-left:10px}

    .actions{display:flex;gap:8px;align-items:center}
    button{cursor:pointer;border:0;padding:8px 10px;border-radius:8px;font-weight:600}
    .btn-book{background:var(--accent);color:white}
    .btn-cancel{background:transparent;border:1px solid rgba(180,35,24,0.12);color:var(--danger)}
    .btn-disabled{background:#f3f4f6;color:var(--muted);cursor:not-allowed;border:1px solid rgba(15,23,42,0.04)}

    footer{font-size:13px;color:var(--muted);margin-top:6px}
    @media (max-width:640px){
      .user input{width:140px}
    }
  </style>
</head>
<body>

  <div class="top">
    <div>
      <h1>Office Meeting Room Booking</h1>
      <div class="legend">Slots: 30 minutes — Day: 9:00 AM to 7:00 PM</div>
    </div>

    <div class="user">
      <input id="userName" placeholder="Enter your name (required to book)" />
      <button class="btn-clear" id="clearAll">Clear All Bookings</button>
    </div>
  </div>

  <div class="roomsWrap" id="roomsContainer"></div>

  <footer>Tip: You can cancel only the slots you booked (to prevent accidental frees).</footer>

<script>
(() => {
  const ROOMS = ["Innovation", "Transformation", "Huddle Room", "Boardroom", "Lounge Area"];
  const START_HOUR = 9; 
  const END_HOUR = 19;  
  const INTERVAL_MIN = 30; 
  const STORAGE_KEY = "meetingRoomBookings_v2";

  function generateSlots(startHour, endHour, intervalMin) {
    const slots = [];
    const startMin = startHour * 60;
    const endMin = endHour * 60;
    for (let t = startMin; t < endMin; t += intervalMin) {
      const start = t;
      const end = t + intervalMin;
      slots.push({
        startMin: start,
        endMin: end,
        label: `${formatTime(start)} - ${formatTime(end)}`
      });
    }
    return slots;
  }

  function formatTime(totalMinutes) {
    const hh = Math.floor(totalMinutes / 60);
    const mm = totalMinutes % 60;
    const period = hh >= 12 ? "PM" : "AM";
    let displayHour = hh % 12;
    if (displayHour === 0) displayHour = 12;
    return `${displayHour}:${String(mm).padStart(2, "0")} ${period}`;
  }

  const SLOTS = generateSlots(START_HOUR, END_HOUR, INTERVAL_MIN);

  function loadBookings() {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) return initializeBookings();
    try {
      const parsed = JSON.parse(raw);
      ROOMS.forEach(room => {
        if (!Array.isArray(parsed[room]) || parsed[room].length !== SLOTS.length) {
          parsed[room] = Array(SLOTS.length).fill(null);
        }
      });
      return parsed;
    } catch (e) {
      return initializeBookings();
    }
  }

  function initializeBookings() {
    const obj = {};
    ROOMS.forEach(r => obj[r] = Array(SLOTS.length).fill(null));
    localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
    return obj;
  }

  let bookings = loadBookings();
  const container = document.getElementById("roomsContainer");
  const userInput = document.getElementById("userName");
  const clearBtn = document.getElementById("clearAll");

  function save() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(bookings));
  }

  function render() {
    container.innerHTML = "";
    ROOMS.forEach(room => {
      const card = document.createElement("div");
      card.className = "roomCard";

      const header = document.createElement("div");
      header.className = "roomHeader";
      const title = document.createElement("h2"); title.textContent = room;
      const info = document.createElement("div"); info.className = "slotMeta";
      const takenCount = bookings[room].filter(x => !!x).length;
      info.textContent = `${takenCount} / ${SLOTS.length} booked`;
      header.appendChild(title);
      header.appendChild(info);

      const slotsWrap = document.createElement("div");
      slotsWrap.className = "slots";

      bookings[room].forEach((bookedBy, slotIndex) => {
        const slot = SLOTS[slotIndex];
        const row = document.createElement("div");
        row.className = "slotRow";

        const left = document.createElement("div");
        left.style.display = "flex"; left.style.flexDirection = "column";
        const label = document.createElement("div"); label.className = "slotLabel";
        label.textContent = slot.label;
        const meta = document.createElement("div"); meta.className = "slotMeta";
        if (!bookedBy) meta.textContent = "Available";
        else meta.textContent = `Booked by ${bookedBy}`;

        left.appendChild(label); left.appendChild(meta);

        const actions = document.createElement("div"); actions.className = "actions";
        if (!bookedBy) {
          const btn = document.createElement("button");
          btn.className = "btn-book";
          btn.textContent = "Book";
          btn.onclick = () => attemptBook(room, slotIndex);
          actions.appendChild(btn);
        } else {
          const currentUser = userInput.value.trim();
          if (currentUser && currentUser === bookedBy) {
            const btn = document.createElement("button");
            btn.className = "btn-cancel";
            btn.textContent = "Cancel";
            btn.onclick = () => attemptCancel(room, slotIndex);
            actions.appendChild(btn);
          } else {
            const btn = document.createElement("button");
            btn.className = "btn-disabled";
            btn.textContent = "Booked";
            btn.disabled = true;
            actions.appendChild(btn);
          }
        }

        row.appendChild(left);
        row.appendChild(actions);
        slotsWrap.appendChild(row);
      });

      card.appendChild(header);
      card.appendChild(slotsWrap);
      container.appendChild(card);
    });
  }

  function attemptBook(room, slotIndex) {
    const user = userInput.value.trim();
    if (!user) {
      alert("Please enter your name before booking a slot.");
      userInput.focus();
      return;
    }
    if (bookings[room][slotIndex]) {
      alert("Sorry, this slot was just taken.");
      render();
      return;
    }
    const confirmMsg = `Book "${room}"\n${SLOTS[slotIndex].label}\nfor: ${user}?`;
    if (!confirm(confirmMsg)) return;
    bookings[room][slotIndex] = user;
    save();
    render();
  }

  function attemptCancel(room, slotIndex) {
    const user = userInput.value.trim();
    if (!user) { alert("Enter your name to cancel your booking."); return; }
    if (bookings[room][slotIndex] !== user) {
      alert("You can only cancel slots you have booked (using the same name).");
      return;
    }
    if (!confirm(`Cancel your booking for "${room}"\n${SLOTS[slotIndex].label}?`)) return;
    bookings[room][slotIndex] = null;
    save();
    render();
  }

  clearBtn.addEventListener("click", () => {
    if (confirm("Are you sure you want to clear ALL bookings?")) {
      bookings = initializeBookings();
      render();
    }
  });

  render();
  userInput.addEventListener("input", () => { render(); });
})();
</script>
</body>
</html>
